# WeBASE管理平台使用手册

## 1、概览

### 1.1基本描述

WeBASE管理平台是由三个WeBASE子系统组成的一套管理FISCO-BCOS联盟链的工具集。

### 1.2主要功能

1. 区块链数据概览
2. 节点管理
3. 合约管理
4. 私钥管理
5. 系统监控
6. 交易审计
7. 登陆账号管理

![](../../images/webase-console-suit/overview.png)

### 1.3部署架构

这套管理工具主要由：节点前置，节点管理，WEB管理台三个WeBASE子系统构成。WeBASE三个服务的部署架构如下图：节点前置需要和区块链节点部署在同一台机器；节点管理和WEB管理台可以同机部署，也可以分开部署。

![](../../images/webase-console-suit/Framework.png)


## 2、使用前提

### 2.1、群组搭建

区块链浏览器展示的数据是从区块链上同步下来的。为了同步数据需要初始化配置（添加群组信息和节点信息），故在同步数据展示前需要用户先搭建好区块链群组。[FISCO-BCOS 2.0](https://github.com/FISCO-BCOS/FISCO-BCOS/tree/release-2.0.1)提供了多种便捷的群组搭建方式。

1. 如果是开发者进行开发调试，建议使用[build_chain](https://fisco-bcos-documentation.readthedocs.io/zh_CN/release-2.0/docs/installation.html)。
2. 如果是开发企业级应用，建议使用企业部署工具[FISCO-BCOS generator](https://fisco-bcos-documentation.readthedocs.io/zh_CN/release-2.0/docs/tutorial/enterprise_quick_start.html)。

两者的主要区别在于build_chain为了使体验更好，搭建速度更快，辅助生成了群组内各个节点的私钥；但企业部署工具出于安全的考虑不辅助生成私钥，需要用户自己生成并设置。

### 2.2、WeBASE管理平台搭建

WeBASE管理平台分为三个部分：节点前置，节点管理，WEB管理台。

当前版本我们提供了两种搭建方式：[**一键搭建**](../WeBASE/install.md)和手动搭建。

#### 2.2.1、一键搭建

适合同机部署，快速体验的情况使用。具体搭建流程参见[**安装文档**](../WeBASE/install.md)。

#### 2.2.2、手动搭建

##### 2.2.2.1、节点前置搭建

节点前置使用Spring Boot的JAVA后台服务，具体搭建流程参见[《节点前置安装说明》](../WeBASE-Front/install.md)。

##### 2.2.2.2、节点管理搭建

节点管理使用Spring Boot的JAVA后台服务，具体搭建流程参见[《节点管理安装说明》](../WeBASE-Node-Manager/install.md)。

##### 2.2.2.3、WEB管理台搭建

WEB管理台使用框架`vue-cli`，具体搭建流程参见[《WeBASE管理平台安装说明》](../WeBASE-Web/README.md#id2)。

## 3、系统初始化配置

服务搭建成功后，可使用网页浏览器访问nginx配置的WEB管理台IP和端口(例如XXX.XXX.XXX.XXX:XXXX)，进入到管理平台页面。管理平台默认用户为admin，默认密码为Abcd1234（第一次登陆成功后会要求重置密码，请按照密码标准设置一个更加安全的密码）。

### 3.1、添加节点前置

 未初始化节点前置的管理平台，会引导去节点管理页面添加节点前置。

![](../../images/webase-console-suit/add_node_front.png)

前置添加完成后，管理平台就会开始拉取群组信息和群组的区块信息。此时数据概览页面应该就有数据了。为了解析和审计区块数据，需要把相关的合约和用户导入到管理平台。具体看下面两个小节。

### 3.2、合约管理

#### 3.2.1添加合约

管理平台提供两种添加合约的方式，一个是新建一个合约，一个是导入已有合约。同时合约编辑器还提供新建目录。用目录的形式管理合约，主要是为了解决同名合约引用的问题。合约添加完成后，需要编译保存。

![](../../images/webase-console-suit/add_contract.png)

#### 3.2.2部署合约

编译后的合约可以部署。

![](../../images/webase-console-suit/deploy.png)

#### 3.2.3合约调用

![](../../images/webase-console-suit/transaction.png)

### 3.3、私钥管理

私钥管理提供了新建私钥用户和导入公钥用户两种用户导入方式。第一种方式主要用于新建用户在管理平台的合约管理中部署和调用合约。第二种方式主要用于把交易和用户关联起来。

![](../../images/webase-console-suit/user_transaction.png)

## 4、各模块的详细介绍

本小节概要介绍管理平台的各个模块，方便大家对WeBASE管理平台套件有一个整体的认识。这套工具集主要提供的管理功能有：

### 4.1区块链数据概览

数据概览页面，展示了区块链的核心数据指标：节点个数，区块数量，交易数量，通过管理台部署的合约数量。关键监控指标：历史15天的交易量。节点信息列表：展示了节点的ID，节点块高，节点view和运行状态。区块信息展示了最近5个块的概览信息，点击更多可以查看更多历史区块。交易信息展示了最近5个交易的概览信息，点击更多可以查看更多历史交易。

![](../../images/webase-console-suit/overview.png)

### 4.2节点管理

节点管理主要提供了前置列表和节点列表的功能。用户可以通过新增节点前置，把新的节点前置添加到前置列表。系统会默认拉取这些前置所在的群组和各个群组的节点信息。

![](../../images/webase-console-suit/node.png)

### 4.3合约管理

合约管理提供了一个图形化的合约IDE环境。这个IDE提供了一整套的合约管理工具：新建合约，保存合约，编译合约，部署合约，调用合约接口。

![](../../images/webase-console-suit/contract.png)

### 4.4私钥管理

在合约管理界面，可以看到合约部署和交易调用功能。这里的私钥管理可以新建私钥用户，然后拿新建用户的私钥来做合约部署和合约交易的签名。

![](../../images/webase-console-suit/key_manager.png)

### 4.5系统监控

系统监控主要包括节点监控和主机监控。节点监控主要有区块高度，pbftview，待打包交易。主机监控主要有主机的CPU，内存，网络和硬盘IO。

![](../../images/webase-console-suit/node_monitor.png)

### 4.6交易审计

联盟链中各个机构按照联盟链委员会制定的规章在链上共享和流转数据。这些规章往往是字面的，大家是否遵守缺乏监管和审计。因此为了规范大家的使用方式，避免链的计算资源和存储资源被某些机构滥用，急需一套服务来辅助监管和审计链上的行为。交易审计就是结合上面的区块链数据，私钥管理和合约管理三者的数据，以区块链数据为原材料，以私钥管理和合约管理为依据做的一个综合性的数据分析功能。交易审计提供可视化的去中心化合约部署和交易监控、审计功能，方便识别链资源被滥用的情况，为联盟链治理提供依据。

交易审计主要指标：

| 主要指标             | 指标描述                                                     |
| :------------------- | ------------------------------------------------------------ |
| 用户交易总量数量统计 | 监控链上各个外部交易账号的每日交易量                         |
| 用户子类交易数量统计 | 监控链上各个外部交易账号的每种类型的每日交易量               |
| 异常交易用户监控     | 监控链上出现的异常交易用户（没在区块链中间件平台登记的交易用户） |
| 异常合约部署监控     | 监控链上合约部署情况，非白名单合约（没在区块链中间件平台登记的合约）记录 |

![](../../images/webase-console-suit/user_audit.png)

### 4.7登陆账号管理

提供管理台登陆账号的管理功能。管理台用户分为两种角色：普通用户和管理员用户。这两者的区别是，管理员拥有管理平台的读写权限，而普通用户只有查看权限。

![](../../images/webase-console-suit/login_user_manager.png)
